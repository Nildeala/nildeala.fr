<!DOCTYPE html>
<html lang="FR-fr">
  <head>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/flux.xml" />
    <!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <meta charset="UTF-8">
    <title>Monsterwm : configuration et joyeusetés</title>
    
    <meta name="author" content="Schoewilliam &lt;schoewilliam@legtux.org&gt;">
    <meta content='initial-scale=1.0' name='viewport'>

    <link rel="icon" type="image/png" href="/images/fav.png">
    
  </head>
  
  <body>
    <section class="index post">
	<figure class="emb">
	<a href="/">
		<img id="cassiopeia" src="/images/photosmall.jpg">
		<h1>schoewilliam</h1>
	</a>

	<nav>
		<a class="lien carnet" href="/#carnet">carnet</a>
		<a class="lien apropos" href="/#moi">à propos</a>
	</nav>
	</figure>
</section>


    <section class="article">

<time datetime='' class="top">11 janvier 2013</time>
<article>


<hgroup>
	<h1>Monsterwm : configuration et joyeusetés</h1>
</hgroup>


<div id="post">
	<p>Comme j&#8217;ai tendance à adorer le renouveau, je me suis mis en tête de tester autre chose que <a href='http://localhost:4000/2012/04/14/wmfs-exposition-de-ma-configuration.html'>WMFS</a>, que je n&#8217;avais pas quitté depuis mon arrivée sur Archlinux. Un Tiling Window Manager, c&#8217;est certain. <strong>monsterwm</strong> se présente comme « Tiny and monstrous ! ». Il n&#8217;a qu&#8217;un seul but : s&#8217;occuper de nos fenêtres. C&#8217;est ainsi qu&#8217;il n&#8217;inclut aucune barre d&#8217;emblée, et s&#8217;avère particulièrement léger.</p>

<p>Deux choix se présentent alors à nous : gardons cet aspect minimaliste de monsterwm (sans quelconque barre supérieure ou inférieure), ou justement lui en enrichir. J&#8217;ai choisi cette seconde option dans un simple souci de confort d&#8217;utilisation. En effet, j&#8217;ai vite ressenti le besoin de pouvoir me situer visuellement parmi mes bureaux virtuels.</p>

<p>Concernant la configuration initale de monsterwm, je vous redirigerai volontiers vers mon <a href='https://github.com/Schoewilliam/configs/blob/master/monsterwm/config.h'>fichier de configuration personnel</a>.</p>

<h2 id='objectif_'>Objectif ?</h2>

<p>Afficher dans une sobre barre — ici <code>dzen2</code> — les bureaux disponibles, leur état (inoccupé/occupé et/ou actif), ainsi que l&#8217;agencement actuellement utilisé.</p>

<p><a href='/images/monster/dzen2.png'><img alt='capture du coin supérieur droit de mon écran' class='align' src='/images/monster/dzen2.png' /></a></p>

<p>À noter avant de continuer, que monsterwm fait du <strong>tiling automatique</strong> (à la manière de DWM, ou Awesome). C&#8217;est-à-dire qu&#8217;il propose plusieurs « layouts » (qu&#8217;on appellera <em>agencements</em> par soucis de chauvinisme inexpliqué) :</p>

<ul>
<li>le « Common Tiling mode » ; une fenêtre maîtresse est positionnée à gauche, tandis que les autres sont empilées à droite.</li>

<li>la Grille ; les fenêtres sont toutes dimensionnées et disposées de manière égale.</li>

<li>le « Bottom Stack tiling mode » ; idem que le premier sus-cité, la fenêtre maîtresse se trouvant en haut.</li>

<li>le plein écran ; que j&#8217;affectionne particulièrement ; chaque fenêtre occupe la totalité de l&#8217;écran.</li>

<li>le <em>Floating Mode</em> ; pour se débarasser de l&#8217;agencement automatique.</li>
</ul>

<h2 id='excution_personnalise'>Exécution personnalisée</h2>

<p>Afin de parvenir à notre objectif, il va falloir créer un fichier qui contiendra une boucle — dont j&#8217;ignore, pour être honnête, tous les détails — exécutée au préalable du gestionnaire de fenêtre. Cela nous permettant de récolter les données nécessaires pour l&#8217;affichage de l&#8217;état de nos bureaux.</p>

<p>Pour cela, au lieu de lancer &#8221;<code>monsterwm</code>&#8221; dans notre <code>.xinitrc</code> (ou autre moyen d&#8217;exécution de votre sessiong xorg), on exécutera ce fichier, que je nommerai personnellement <code>runmonster.exec</code> et qui aura pour contenu :</p>

<pre><code>#!/usr/bin/env bash

# First define colors
norm_fg=&quot;#909090&quot;
norm_bg=&quot;#1a1a1a&quot;
sel_fg=&quot;#ffffff&quot;
sel_bg=&quot;#3a3a3a&quot; 
err_fg=&quot;#ffffff&quot;
err_bg=&quot;#f2777a&quot;

: &quot;${wm:=&quot;monsterwm&quot;}&quot;
: &quot;${ff:=&quot;/tmp/monsterwm.fifo&quot;}&quot;

[[ -p $ff ]] || mkfifo -m 600 &quot;$ff&quot;

while read -t 2 -r wmout || true; do
    # filter output to only what we want to match and parse
    if [[ $wmout =~ ^(([[:digit:]]+:)+[[:digit:]]+ ?)+.*$ ]]; then
        read -ra desktops &lt;&lt;&lt; &quot;$wmout&quot; &amp;&amp; unset r
            for desktop in &quot;${desktops[@]}&quot;; do
                # set values for
                # d - the desktop id
                # w - number of windows in that desktop
                # m - tiling layout/mode for that desktop
                # c - whether that desktop is the current (1) or not (0)
                # u - whether a window in that desktop has an urgent hint set (1) or not (0)
                IFS=&#39;:&#39; read -r d w m c u &lt;&lt;&lt; &quot;$desktop&quot;
                # Set the icon for desktops with windows
                ic=&quot; &quot;
                ((w)) &amp;&amp; ic=&quot; *&quot;
                # name each desktop
                      case $d in
                        0) d=&quot;u &quot; ;;
                        1) d=&quot;d &quot; ;;
                        2) d=&quot;t &quot; ;;
                        3) d=&quot;q &quot; ;;
                        4) d=&quot;c &quot; ;;
                        5) d=&quot;sx &quot; ;;
                        6) d=&quot;sp &quot; ;;
                      esac
                # we will also display the current desktop&#39;s tiling layout/mode
                      ((c)) &amp;&amp; fg=&quot;$sel_fg&quot; bg=&quot;$sel_bg&quot; &amp;&amp; case $m in
                          # name each layout/mode with a symbol
                          0) i=&quot; [T]&quot; ;;
                          1) i=&quot; [$w]&quot; ;;
                          2) i=&quot; [b]&quot; ;;
                          3) i=&quot; [G]&quot; ;;
                          4) i=&quot; [F]&quot; ;;
                      esac || fg=&quot;$norm_fg&quot; bg=&quot;$norm_bg&quot;
                      # if the desktop has an urgent hint its color should be err_fg/err_bg
                      ((u)) &amp;&amp; fg=&quot;$err_fg&quot; bg=&quot;$err_bg&quot;
                      # print the desktop name
                      r+=&quot;^bg($norm_bg)^bg($bg)^fg($fg)$ic$d^fg($norm_fg)^bg($norm_bg)&quot;
            done
    fi        
    printf &quot;%s%s\n&quot; &quot;$r&quot; &quot;$i&quot;
done &lt; &quot;$ff&quot; | dzen2 -fg &quot;#cccccc&quot; -bg &quot;#1a1a1a&quot; -h 20 -fn &quot;-*-envypn-medium-*-*--13-*-*-*-*-*-*-*&quot; -ta l -w 300 -e &quot;button2=stick&quot; &amp;
    
while :; do &quot;$wm&quot; || break; done | tee -a &quot;$ff&quot;</code></pre>

<p>Ce fichier permet au passage d&#8217;attribuer un nom, un symbole, ou autre, à chacun de ces bureaux, et des pavages, en plus des choix de couleurs pour dzen2.</p>

<p>Mon <code>.xinitrc</code> aura donc l&#8217;apparence suivante :</p>

<pre><code># […]
setxkbmap -layout fr -variant bepo &amp;
xsetroot -cursor_name &quot;arrow&quot; &amp;
numlockx on &amp;

runmonster.exec</code></pre>

<h2 id='voil'><em>voilà</em></h2>
<a href='http://schoewilliam.deviantart.com/art/MonsterWM-January-2013-archlinux-346452273' target='_blank'><img class='align right' src='/images/apropos/2013-01mini.png' /></a>
<p>Si tout se déroule correctement, au prochain <code>$ startx</code>, une barre — dzen2 — se logera à la position et selon l&#8217;apparence définies, et vous permettra de vous situer <strong>visuellement</strong> parmi vos fenêtres, et vos bureaux virtuels.</p>

<p>Pour en savoir davantage, rendez-vous sur <a href='https://bbs.archlinux.org/viewtopic.php?id=132122'>le sujet dédié sur les forums d&#8217;Archlinux.org</a>. C&#8217;est bien entendu à cet endroit que j&#8217;ai pu trouver bien des astuces, parmi lesquelles l&#8217;objet de ce billet.</p>
</div>

</article>

</section>


<section class="comments">
<div class="jskomment" id="comments" title="http://schoewilliam.legtux.org/2013/01/11/monsterwm.html"></div>
<script src="/js/jskomment.js"></script>
</section>



    <footer>
	<div>
		<div><span style="margin-right:5px;opacity:0.3;">William Dorffer.</span>
		</div>
		<div><span style="margin-right:5px;opacity:0.3;">Carnets amis //</span>
			
			<a href="http://id-libre.org/blogigor" title="BlogiGor">BlogiGor</a>
			
			<a href="http://coreight.com" title="Coreight">Coreight</a>
			
			<a href="http://tetedulinuxien.fr" title="Dans la tête du Linuxien">Dans la tête du Linuxien</a>
			
			<a href="http://identitools.fr" title="Identitools">Identitools</a>
			
			<a href="http://postblue.info" title="Postblue">Postblue</a>
			
		</div>
		<div><span style="margin-right:5px;opacity:0.3;">Liens //</span>
			
			<a href="http://legtux.org/" title="<strong>Legtux</strong>"><strong>Legtux</strong></a>
			
			<a href="http://mart-e.be" title="mart-e">mart-e</a>
			
			<a href="http://lehollandaisvolant.net/" title="Le Hollandais Volant">Le Hollandais Volant</a>
			
			<a href="http://src.radiocampus.be/" title="Source, Radio Campus Bruxelles">Source, Radio Campus Bruxelles</a>
			
		</div>
	</div>
</footer>

  </body>
</html>
